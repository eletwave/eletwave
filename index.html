<!doctype html>
<html lang="it">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ELETWAVE | Impianti elettrici smart</title>
    <meta
      name="description"
      content="ELETWAVE realizza impianti elettrici moderni, soluzioni smart energy e sicurezza per abitazioni e aziende."
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="page">
      <div class="sticky-nav">
        <div class="nav-links">
          <a class="nav-item nav-item--primary" href="#chi-siamo" data-i18n="nav.about">Chi siamo</a>
          <a class="nav-item nav-item--services" href="#servizi" data-i18n="nav.services">Servizi</a>
          <a class="nav-item nav-item--service" href="#elettrico" data-i18n="nav.electrical">Impianti elettrici</a>
          <a class="nav-item nav-item--service" href="#fotovoltaico" data-i18n="nav.solar">Fotovoltaico</a>
          <a class="nav-item nav-item--service" href="#wallbox" data-i18n="nav.wallbox">Wallbox</a>
          <a class="nav-item nav-item--service" href="#sicurezza" data-i18n="nav.security">Videosorveglianza</a>
          <a class="nav-item nav-item--service" href="#domotica" data-i18n="nav.domotics">Domotica</a>
          <a class="nav-item nav-item--service" href="#reti" data-i18n="nav.networks">Reti</a>
          <a class="nav-item nav-item--primary" href="#contatti" data-i18n="nav.contacts">Contatti</a>
        </div>
        <div class="lang-toggle">
          <select class="lang-select" id="lang-select" aria-label="Seleziona lingua">
            <option value="it">ðŸ‡®ðŸ‡¹</option>
            <option value="en">ðŸ‡¬ðŸ‡§</option>
            <option value="sl">ðŸ‡¸ðŸ‡®</option>
          </select>
        </div>
      </div>
      <header class="site-header">
        <div class="logo-header">
          <img class="logo logo-large" src="assets/logo.png" alt="ELETWAVE logo" />
        </div>
        <div class="header-scroll-hint" aria-hidden="true">
          <span class="header-scroll-hint__arrow"></span>
          <span class="header-scroll-hint__arrow"></span>
        </div>
      </header>
      <main>
        <section class="company" id="chi-siamo">
          <h1 class="hero-title">
            <span class="hero-title__main" data-i18n="hero.title">Energia intelligente, sicurezza concreta.</span>
          </h1>
          <div class="company-grid">
            <div class="hero-copy">
              <p class="lead" data-i18n="hero.lead">
                Eletwave e una realta dinamica specializzata nella progettazione, realizzazione e manutenzione di impianti elettrici e soluzioni tecnologiche integrate per privati e aziende. Con sede in Friuli Venezia Giulia e operativita su un ampio territorio, offriamo servizi completi che spaziano dagli impianti elettrici civili e industriali alla domotica, sicurezza, automazioni ed energie rinnovabili, accompagnando il cliente in ogni fase del progetto: dall'analisi delle esigenze fino all'assistenza post-installazione.
              </p>
              <button class="hero-more-button" type="button" aria-expanded="false" aria-controls="hero-more-content">
                <span class="hero-more-button__icon" aria-hidden="true">
                  <span class="scroll-hint__chevron hero-more-button__chevron"></span>
                  <span class="scroll-hint__chevron hero-more-button__chevron"></span>
                  <span class="scroll-hint__chevron hero-more-button__chevron"></span>
                </span>
                <span class="hero-more-button__label">Approfondisci</span>
              </button>
              <div class="hero-more-content" id="hero-more-content" aria-hidden="true">
                <p class="lead lead--more" data-i18n="hero.lead.more.1">
                  L'azienda nasce dall'iniziativa di professionisti del settore con una solida esperienza nell'impiantistica elettrica e una forte attenzione all'innovazione tecnologica. La competenza maturata sul campo, unita alla formazione continua e al costante aggiornamento sulle normative di sicurezza, consente di proporre soluzioni efficienti, sicure e su misura, progettate per migliorare comfort, prestazioni energetiche e funzionalita degli ambienti.
                </p>
                <p class="lead lead--more" data-i18n="hero.lead.more.2">
                  L'obiettivo di Eletwave e diventare un punto di riferimento per chi cerca qualita, trasparenza e supporto costante nel tempo. Crediamo nel valore del rapporto diretto con il cliente, nella cura dei dettagli e in un servizio completo capace di coniugare innovazione, affidabilita e sostenibilita, garantendo risultati concreti e duraturi.
                </p>
              </div>
            </div>
            <div class="service-areas">
              <div class="service-areas__icon" aria-hidden="true">
                <img src="assets/icon-place-marker.png" alt="" />
              </div>
              <div class="service-areas__list">
                <p class="service-areas__title" data-i18n="areas.title">Operativi a</p>
                <div class="area-scroller">
                  <div class="area-track">
                    <span>Gorizia</span><span>Udine</span><span>Trieste</span><span>Nova Gorica</span>
                    <span>Grado</span><span>Lignano</span><span>Pordenone</span><span>Tarvisio</span>
                    <span>Venezia</span><span>Treviso</span><span>Padova</span><span>Desenzano</span>
                    <span>Nova Gorica</span><span>Koper</span>
                    <span>Gorizia</span><span>Udine</span><span>Trieste</span><span>Nova Gorica</span>
                    <span>Grado</span><span>Lignano</span><span>Pordenone</span><span>Tarvisio</span>
                    <span>Venezia</span><span>Treviso</span><span>Padova</span><span>Desenzano</span>
                    <span>Nova Gorica</span><span>Koper</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </section>

        <section class="services-scroll" id="servizi">
          <div class="section-title section-title--beam">
            <h2 data-i18n="services.title">Servizi</h2>
          </div>
          <div class="scroll-container">
            <article class="service-card service-card--grey scroll-card" id="elettrico">
              <div class="service-card__content">
                <h3 data-i18n="services.electrical.title">Impianti elettrici</h3>
                <div class="service-media">
                  <img
                    class="service-image"
                    src="assets/man-electrical-technician-working-switchboard-with-fuses-installation-connection-electrical-equipment-close-up.webp"
                    loading="lazy"
                    decoding="async"
                    alt="Impianto elettrico"
                  />
                  <p class="service-description" data-i18n="services.electrical.desc">
                    Realizziamo impianti civili e industriali a norma, con quadri, linee e punti luce progettati in base agli ambienti. Eseguiamo verifiche strumentali, adeguamenti normativi e manutenzione programmata. Interveniamo rapidamente su guasti e anomalie per ridurre i tempi di fermo.
                  </p>
                </div>
              </div>
            </article>

            <article class="service-card service-card--yellow scroll-card" id="fotovoltaico">
              <div class="service-card__content">
                <h3 data-i18n="services.solar.title">Impianti fotovoltaici con accumulo</h3>
                <div class="service-media">
                  <img
                    class="service-image"
                    src="assets/impianto%20fotovoltaico.webp"
                    loading="lazy"
                    decoding="async"
                    alt="Impianto fotovoltaico"
                  />
                  <p class="service-description" data-i18n="services.solar.desc">
                    Progettiamo impianti fotovoltaici con accumulo dimensionati sui consumi reali, per aumentare autoconsumo ed efficienza. Installiamo inverter e batterie di ultima generazione con monitoraggio da app. Gestiamo pratiche, configurazione e assistenza per mantenere alte le prestazioni nel tempo.
                  </p>
                </div>
              </div>
            </article>

            <article class="service-card service-card--green scroll-card" id="wallbox">
              <div class="service-card__content">
                <h3 data-i18n="services.wallbox.title">Wallbox per ricarica EV</h3>
                <div class="service-media">
                  <img
                    class="service-image"
                    src="assets/ChatGPT%20Image%2026%20gen%202026,%2010_29_34.webp"
                    loading="lazy"
                    decoding="async"
                    alt="Wallbox per ricarica auto elettriche"
                  />
                  <p class="service-description" data-i18n="services.wallbox.desc">
                    Forniamo wallbox per ricarica domestica e aziendale con potenza configurata e protezioni dedicate. Integriamo la ricarica con impianto fotovoltaico e gestione intelligente dei carichi. Configuriamo fasce orarie, priorita e monitoraggio per una ricarica sicura, veloce ed efficiente.
                  </p>
                </div>
              </div>
            </article>

            <article class="service-card service-card--red scroll-card" id="sicurezza">
              <div class="service-card__content">
                <h3 data-i18n="services.security.title">Videosorveglianza e antifurti</h3>
                <div class="service-media">
                  <img
                    class="service-image"
                    src="assets/ChatGPT%20Image%2026%20gen%202026,%2010_42_49.webp"
                    loading="lazy"
                    decoding="async"
                    alt="Sistema di allarme e videosorveglianza"
                  />
                  <p class="service-description" data-i18n="services.security.desc">
                    Installiamo sistemi di videosorveglianza e antifurto personalizzati per abitazioni, uffici e attivita commerciali. Configuriamo accesso remoto, notifiche in tempo reale e registrazione protetta su cloud o NVR. Ottimizziamo copertura e sensibilita per ridurre falsi allarmi e aumentare la sicurezza.
                  </p>
                </div>
              </div>
            </article>

            <article class="service-card service-card--blue scroll-card" id="domotica">
              <div class="service-card__content">
                <h3 data-i18n="services.domotics.title">Domotica</h3>
                <div class="service-media">
                  <img
                    class="service-image"
                    src="assets/ChatGPT%20Image%2023%20gen%202026,%2018_09_17.webp"
                    loading="lazy"
                    decoding="async"
                    alt="Sistema domotico"
                  />
                  <p class="service-description" data-i18n="services.domotics.desc">
                    Progettiamo soluzioni domotiche per controllare luci, clima, tapparelle e accessi da app, voce o scenari automatici. Integriamo dispositivi compatibili in un unico sistema semplice da usare. Miglioriamo comfort, efficienza energetica e sicurezza con logiche su misura per ogni ambiente.
                  </p>
                </div>
              </div>
            </article>

            <article class="service-card service-card--cyan scroll-card" id="reti">
              <div class="service-card__content">
                <h3 data-i18n="services.networks.title">Reti e cablaggi</h3>
                <div class="service-media">
                  <img
                    class="service-image"
                    src="assets/ChatGPT%20Image%2023%20gen%202026,%2018_09_07.webp"
                    loading="lazy"
                    decoding="async"
                    alt="Reti e cablaggi"
                  />
                  <p class="service-description" data-i18n="services.networks.desc">
                    Realizziamo reti dati e cablaggi strutturati per case, uffici e capannoni con rack ordinati e punti certificati. Configuriamo switch, Wi-Fi e segmentazione di rete per connessioni stabili e veloci. Eseguiamo test e collaudo per garantire continuita operativa e affidabilita nel tempo.
                  </p>
                </div>
              </div>
            </article>
          </div>
          <div class="scroll-hint">
            <button
              class="scroll-hint__button scroll-hint__button--prev"
              type="button"
              aria-label="Scorri verso sinistra"
            >
              <span class="scroll-hint__button-icon" aria-hidden="true">
                <span class="scroll-hint__chevron scroll-hint__button-chevron"></span>
                <span class="scroll-hint__chevron scroll-hint__button-chevron"></span>
                <span class="scroll-hint__chevron scroll-hint__button-chevron"></span>
              </span>
            </button>
            <span class="scroll-hint__label" data-i18n="services.scroll">Scorri</span>
            <button
              class="scroll-hint__button scroll-hint__button--next"
              type="button"
              aria-label="Scorri verso destra"
            >
              <span class="scroll-hint__button-icon" aria-hidden="true">
                <span class="scroll-hint__chevron scroll-hint__button-chevron"></span>
                <span class="scroll-hint__chevron scroll-hint__button-chevron"></span>
                <span class="scroll-hint__chevron scroll-hint__button-chevron"></span>
              </span>
            </button>
          </div>
        </section>
      </main>

      <footer class="footer" id="contatti">
        <div class="footer-content">
          <div class="footer-layout">
            <section class="footer-block footer-block--contacts">
              <h2 data-i18n="contacts.title">Contatti</h2>
              <div class="contact-icons social-links social-links--contact">
                <a href="tel:+393930036372" aria-label="Telefono">
                  <span class="social-icon" aria-hidden="true">
                    <img src="assets/icon-phone.png" alt="" />
                  </span>
                </a>
                <a href="mailto:eletwave@gmail.com" aria-label="Email">
                  <span class="social-icon" aria-hidden="true">
                    <img src="assets/icon-email.png" alt="" />
                  </span>
                </a>
                <a
                  href="https://www.instagram.com/eletwave/"
                  target="_blank"
                  rel="noopener noreferrer"
                  aria-label="Instagram"
                >
                  <span class="social-icon" aria-hidden="true">
                    <img src="assets/icon-instagram.png" alt="" />
                  </span>
                </a>
                <a
                  href="https://wa.me/393930036372"
                  target="_blank"
                  rel="noopener noreferrer"
                  aria-label="WhatsApp"
                >
                  <span class="social-icon" aria-hidden="true">
                    <img src="assets/icon-whatsapp.png" alt="" />
                  </span>
                </a>
              </div>
              <p data-i18n="contacts.phone">Telefono: +39 3930036372</p>
              <p data-i18n-html="contacts.email">Email: <a href="mailto:eletwave@gmail.com">eletwave@gmail.com</a></p>
              <p data-i18n="contacts.area">Zona operativa: FVG</p>
              <p data-i18n="contacts.vat">P.IVA: 01287600314</p>
            </section>

            <section class="footer-block footer-block--quote" aria-labelledby="quote-title">
              <h3 id="quote-title" data-i18n="quote.title">Richiedi un preventivo</h3>
              <p class="quote-lead" data-i18n="quote.lead">
                Compila il modulo e ti ricontattiamo con una proposta su misura.
              </p>
              <form class="quote-form" id="quote-form">
                <label class="quote-field" for="quote-name">
                  <span data-i18n="quote.name">Nome e cognome</span>
                  <input
                    id="quote-name"
                    name="name"
                    type="text"
                    autocomplete="name"
                    required
                    data-i18n-placeholder="quote.placeholder.name"
                    placeholder="Mario Rossi"
                  />
                </label>
                <label class="quote-field" for="quote-phone">
                  <span data-i18n="quote.phone">Telefono</span>
                  <input
                    id="quote-phone"
                    name="phone"
                    type="tel"
                    autocomplete="tel"
                    required
                    data-i18n-placeholder="quote.placeholder.phone"
                    placeholder="+39 3xx xxx xxxx"
                  />
                </label>
                <label class="quote-field" for="quote-email">
                  <span data-i18n="quote.email">Email</span>
                  <input
                    id="quote-email"
                    name="email"
                    type="email"
                    autocomplete="email"
                    required
                    data-i18n-placeholder="quote.placeholder.email"
                    placeholder="nome@azienda.it"
                  />
                </label>
                <label class="quote-field" for="quote-service">
                  <span data-i18n="quote.service">Servizio di interesse</span>
                  <select id="quote-service" name="service" required>
                    <option value="" data-i18n="quote.service.choose">Seleziona un servizio</option>
                    <option data-i18n="quote.service.electrical">Impianti elettrici</option>
                    <option data-i18n="quote.service.solar">Impianti fotovoltaici</option>
                    <option data-i18n="quote.service.wallbox">Wallbox</option>
                    <option data-i18n="quote.service.security">Videosorveglianza e antifurti</option>
                    <option data-i18n="quote.service.domotics">Domotica</option>
                    <option data-i18n="quote.service.networks">Reti e cablaggi</option>
                  </select>
                </label>
                <label class="quote-field" for="quote-message">
                  <span data-i18n="quote.message">Dettagli del progetto</span>
                  <textarea
                    id="quote-message"
                    name="message"
                    rows="4"
                    required
                    data-i18n-placeholder="quote.placeholder.message"
                    placeholder="Descrivi brevemente l'intervento richiesto"
                  ></textarea>
                </label>
                <button class="quote-submit" type="submit" data-i18n="quote.submit">Invia richiesta</button>
              </form>
              <p class="quote-note" data-i18n="quote.note">Risposta rapida via email o telefono.</p>
            </section>
          </div>
        </div>
        <p class="footer-note" data-i18n="footer.note">ELETWAVE. smart energy &amp; security solutions</p>
      </footer>
    </div>
    <script>
      const heroTitle = document.querySelector(".hero-title");
      const headerScrollHint = document.querySelector(".header-scroll-hint");
      const beamTitle = document.querySelector(".section-title--beam");
      const cardsBeam = document.querySelector(".cards-beam");
      const companySection = document.querySelector(".company");
      const cards = Array.from(document.querySelectorAll(".scroll-card"));
      const serviceMediaItems = Array.from(document.querySelectorAll(".service-media"));
      const serviziTitle = document.querySelector("#servizi .section-title h2");
      const scrollContainer = document.querySelector(".scroll-container");
      const scrollPrevButton = document.querySelector(".scroll-hint__button--prev");
      const scrollNextButton = document.querySelector(".scroll-hint__button--next");
      const servicesSection = document.querySelector(".services-scroll");
      const areaScroller = document.querySelector(".area-scroller");
      const areaItems = areaScroller
        ? Array.from(areaScroller.querySelectorAll(".area-track span"))
        : [];
      const stickyNav = document.querySelector(".sticky-nav");
      const langSelect = document.querySelector("#lang-select");
      const heroMoreButton = document.querySelector(".hero-more-button");
      const heroMoreContent = document.querySelector("#hero-more-content");
      const heroMoreLabel = document.querySelector(".hero-more-button__label");
      const quoteForm = document.querySelector("#quote-form");
      const quoteServiceSelect = document.querySelector("#quote-service");
      const navLinks = Array.from(document.querySelectorAll(".sticky-nav .nav-item[href^=\"#\"]"));
      const internalAnchorLinks = Array.from(document.querySelectorAll("a[href^=\"#\"]"));
      const navLinkByHash = new Map(
        navLinks.map((link) => [link.getAttribute("href"), link])
      );
      const mainSections = ["#chi-siamo", "#servizi", "#contatti"]
        .map((hash) => ({ hash, el: document.querySelector(hash) }))
        .filter((item) => item.el);
      const serviceCardByHash = new Map(
        cards
          .filter((card) => card.id)
          .map((card) => [`#${card.id}`, card])
      );
      const prefersReducedMotion = window.matchMedia("(prefers-reduced-motion: reduce)").matches;
      let ticking = false;
      let cardsTicking = false;
      let areaLastTick = 0;
      let areaLoopId = null;
      let serviceAlignTimeout = null;
      let getClosestCard = null;
      let currentLang = "it";

      const setCurrentNav = (hash) => {
        navLinks.forEach((link) => link.classList.remove("is-current"));
        const target = navLinkByHash.get(hash);
        if (target) {
          target.classList.add("is-current");
        }
      };

      const getStickyOffset = () => {
        if (!stickyNav) {
          return 16;
        }
        return Math.ceil(stickyNav.getBoundingClientRect().height) + 14;
      };

      const scrollToHashTarget = (hash, behavior = prefersReducedMotion ? "auto" : "smooth") => {
        const target = document.querySelector(hash);
        if (!target) {
          return false;
        }
        const stickyOffset = getStickyOffset();
        let top = target.getBoundingClientRect().top + window.scrollY - stickyOffset;
        if (hash === "#chi-siamo") {
          const servicesTarget = document.querySelector("#servizi");
          if (servicesTarget) {
            const servicesTop = servicesTarget.getBoundingClientRect().top + window.scrollY;
            const topBeforeServices = servicesTop - window.innerHeight - 6;
            top = Math.min(top, topBeforeServices);
          }
        }
        window.scrollTo({
          top: Math.max(0, top),
          behavior
        });
        return true;
      };

      const scrollToServiceByHash = (hash, behavior = prefersReducedMotion ? "auto" : "smooth") => {
        if (!scrollContainer) {
          return false;
        }
        const targetCard = serviceCardByHash.get(hash);
        if (!targetCard) {
          return false;
        }
        scrollToHashTarget("#servizi", behavior);
        const alignCard = (cardBehavior = behavior) => {
          const containerWidth = scrollContainer.clientWidth;
          const maxLeft = Math.max(0, scrollContainer.scrollWidth - containerWidth);
          const targetLeft =
            targetCard.offsetLeft + targetCard.offsetWidth / 2 - containerWidth / 2;
          const nextLeft = Math.min(Math.max(targetLeft, 0), maxLeft);
          scrollContainer.scrollTo({
            left: nextLeft,
            behavior: cardBehavior
          });
        };
        alignCard(behavior);
        if (serviceAlignTimeout !== null) {
          window.clearTimeout(serviceAlignTimeout);
        }
        serviceAlignTimeout = window.setTimeout(() => {
          alignCard(prefersReducedMotion ? "auto" : "smooth");
          serviceAlignTimeout = null;
        }, 500);
        return true;
      };

      const getCurrentMainSectionHash = () => {
        const markerY = window.scrollY + window.innerHeight * 0.38;
        let activeHash = mainSections[0] ? mainSections[0].hash : "#chi-siamo";
        mainSections.forEach(({ hash, el }) => {
          if (el.offsetTop <= markerY) {
            activeHash = hash;
          }
        });
        return activeHash;
      };

      const updateActiveNav = () => {
        let targetHash = getCurrentMainSectionHash();
        const hasReachedServices = servicesSection
          ? window.scrollY >= servicesSection.offsetTop - getStickyOffset() - 2
          : false;
        if (targetHash === "#servizi" && !hasReachedServices) {
          targetHash = "#chi-siamo";
        }
        if (targetHash === "#servizi" && hasReachedServices && typeof getClosestCard === "function") {
          const closest = getClosestCard();
          if (closest && closest.id) {
            const serviceHash = `#${closest.id}`;
            const serviceLink = navLinkByHash.get(serviceHash);
            if (serviceLink && window.getComputedStyle(serviceLink).display !== "none") {
              targetHash = serviceHash;
            }
          }
        }
        setCurrentNav(targetHash);
      };

      const updateHeroMoreLabel = (lang) => {
        if (!heroMoreButton || !heroMoreLabel) {
          return;
        }
        const dict = translations[lang] || translations.it;
        const isExpanded = heroMoreButton.getAttribute("aria-expanded") === "true";
        heroMoreLabel.textContent = isExpanded ? dict["hero.less"] : dict["hero.more"];
      };

      const syncHeroMoreHeight = () => {
        if (!heroMoreButton || !heroMoreContent) {
          return;
        }
        const isExpanded = heroMoreButton.getAttribute("aria-expanded") === "true";
        heroMoreContent.style.maxHeight = isExpanded ? `${heroMoreContent.scrollHeight}px` : "0px";
      };

      const setHeroMoreExpanded = (expanded) => {
        if (!heroMoreButton || !heroMoreContent) {
          return;
        }
        heroMoreButton.setAttribute("aria-expanded", String(expanded));
        heroMoreContent.setAttribute("aria-hidden", String(!expanded));
        heroMoreButton.classList.toggle("is-open", expanded);
        heroMoreContent.classList.toggle("is-open", expanded);
        if (expanded) {
          heroMoreContent.style.maxHeight = `${heroMoreContent.scrollHeight}px`;
        } else {
          heroMoreContent.style.maxHeight = `${heroMoreContent.scrollHeight}px`;
          window.requestAnimationFrame(() => {
            heroMoreContent.style.maxHeight = "0px";
          });
        }
        updateHeroMoreLabel(currentLang);
      };

      const setServiceDescriptionExpanded = (media, expanded) => {
        if (!media) {
          return;
        }
        media.classList.toggle("is-expanded", expanded);
        media.setAttribute("aria-expanded", String(expanded));
      };

      const toggleServiceDescription = (media) => {
        if (!media) {
          return;
        }
        const nextExpanded = !media.classList.contains("is-expanded");
        serviceMediaItems.forEach((item) => {
          if (item !== media) {
            setServiceDescriptionExpanded(item, false);
          }
        });
        setServiceDescriptionExpanded(media, nextExpanded);
      };

      const updateScrollEffects = () => {
        const scrollY = window.scrollY;
        const scrollRange = Math.max(document.documentElement.scrollHeight - window.innerHeight, 1);
        const scrollProgress = Math.min(scrollY / scrollRange, 1);
        if (stickyNav) {
          if (scrollY > 60) {
            stickyNav.classList.add("is-scrolled");
          } else {
            stickyNav.classList.remove("is-scrolled");
          }
          stickyNav.style.setProperty("--scroll-progress", scrollProgress.toFixed(4));
        }

        if (headerScrollHint) {
          const fadeStart = 60;
          const fadeEnd = 430;
          const progress = Math.min(
            Math.max((scrollY - fadeStart) / Math.max(fadeEnd - fadeStart, 1), 0),
            1
          );
          headerScrollHint.style.opacity = (1 - progress).toFixed(2);
          headerScrollHint.style.transform = `translateX(-50%) translateY(${(progress * 14).toFixed(1)}px)`;
        }
        if (prefersReducedMotion) {
          if (heroTitle) {
            heroTitle.style.transform = "none";
            heroTitle.classList.add("is-lit");
          }
          if (serviziTitle) {
            serviziTitle.style.transform = "none";
          }
          if (beamTitle) {
            beamTitle.classList.add("is-lit");
          }
          if (cardsBeam) {
            cardsBeam.classList.add("is-lit");
          }
          if (companySection) {
            companySection.style.setProperty("--circuit-opacity", "0.5");
            companySection.style.setProperty("--circuit-scale", "1");
          }
          if (servicesSection) {
            servicesSection.classList.add("is-revealed");
          }
          updateActiveNav();
          ticking = false;
          return;
        }
        if (heroTitle) {
          const companyTop = companySection
            ? companySection.offsetTop - getStickyOffset()
            : 0;
          const localScroll = companySection
            ? Math.max(0, scrollY - companyTop)
            : scrollY;
          const lift = Math.min(120, localScroll * 0.35);
          heroTitle.style.transform = `translateY(${-lift}px)`;
          const rect = heroTitle.getBoundingClientRect();
          const vh = window.innerHeight;
          if (rect.top < vh * 0.8 && rect.bottom > vh * 0.2) {
            heroTitle.classList.add("is-lit");
          } else {
            heroTitle.classList.remove("is-lit");
          }
        }

        if (serviziTitle) {
          const rect = serviziTitle.getBoundingClientRect();
          const vh = window.innerHeight;
          const progress = Math.min(1, Math.max(0, (vh * 0.85 - rect.top) / (vh * 0.45)));
          serviziTitle.style.transform = `translateY(${-24 * progress}px)`;
        }

        if (beamTitle) {
          const rect = beamTitle.getBoundingClientRect();
          const vh = window.innerHeight;
          if (rect.top < vh * 0.75 && rect.bottom > 0) {
            beamTitle.classList.add("is-lit");
          } else {
            beamTitle.classList.remove("is-lit");
          }
        }

        if (cardsBeam) {
          const rect = cardsBeam.getBoundingClientRect();
          const vh = window.innerHeight;
          if (rect.top < vh * 0.8 && rect.bottom > 0) {
            cardsBeam.classList.add("is-lit");
          } else {
            cardsBeam.classList.remove("is-lit");
          }
        }

        if (companySection) {
          const rect = companySection.getBoundingClientRect();
          const vh = window.innerHeight;
          const center = rect.top + rect.height / 2;
          const distance = Math.abs(vh / 2 - center);
          const range = vh * 0.8;
          const intensity = Math.max(0, 1 - distance / range);
          const scale = 0.85 + intensity * 0.2;
          companySection.style.setProperty("--circuit-opacity", (0.15 + intensity * 0.55).toFixed(3));
          companySection.style.setProperty("--circuit-scale", scale.toFixed(3));
        }

        if (servicesSection) {
          const rect = servicesSection.getBoundingClientRect();
          const vh = window.innerHeight;
          if (rect.top < vh * 0.8) {
            servicesSection.classList.add("is-revealed");
          }
        }

        updateActiveNav();
        ticking = false;
      };

      const onScroll = () => {
        if (!ticking) {
          window.requestAnimationFrame(updateScrollEffects);
          ticking = true;
        }
      };

      window.addEventListener("scroll", onScroll, { passive: true });
      window.addEventListener("resize", onScroll);
      updateScrollEffects();

      const updateAreaFocus = () => {
        if (!areaScroller || areaItems.length === 0) {
          return;
        }
        const scrollerRect = areaScroller.getBoundingClientRect();
        const centerY = scrollerRect.top + scrollerRect.height / 2;
        let active = null;
        let activeDist = Infinity;
        const above = [];
        const below = [];

        areaItems.forEach((item) => {
          item.classList.remove("is-active", "is-up-1", "is-up-2", "is-down-1", "is-down-2");
          const rect = item.getBoundingClientRect();
          const itemCenter = rect.top + rect.height / 2;
          const dist = Math.abs(itemCenter - centerY);
          if (dist < activeDist) {
            activeDist = dist;
            active = item;
          }
        });

        areaItems.forEach((item) => {
          if (item === active) {
            return;
          }
          const rect = item.getBoundingClientRect();
          const itemCenter = rect.top + rect.height / 2;
          const delta = itemCenter - centerY;
          const dist = Math.abs(delta);
          if (delta < 0) {
            above.push({ item, dist });
          } else {
            below.push({ item, dist });
          }
        });

        if (active) {
          active.classList.add("is-active");
        }

        above.sort((a, b) => a.dist - b.dist);
        below.sort((a, b) => a.dist - b.dist);

        if (above[0]) {
          above[0].item.classList.add("is-up-1");
        }
        if (above[1]) {
          above[1].item.classList.add("is-up-2");
        }
        if (below[0]) {
          below[0].item.classList.add("is-down-1");
        }
        if (below[1]) {
          below[1].item.classList.add("is-down-2");
        }
      };

      const areaLoop = (time) => {
        if (!areaScroller || areaItems.length === 0 || prefersReducedMotion) {
          areaLoopId = null;
          return;
        }
        const rect = areaScroller.getBoundingClientRect();
        const inView = rect.bottom > 0 && rect.top < window.innerHeight;
        if (document.hidden || !inView) {
          areaLoopId = null;
          return;
        }
        if (time - areaLastTick > 120) {
          updateAreaFocus();
          areaLastTick = time;
        }
        areaLoopId = window.requestAnimationFrame(areaLoop);
      };

      const ensureAreaLoop = () => {
        if (!areaScroller || areaItems.length === 0 || prefersReducedMotion) {
          return;
        }
        const rect = areaScroller.getBoundingClientRect();
        const inView = rect.bottom > 0 && rect.top < window.innerHeight;
        if (!document.hidden && inView && areaLoopId === null) {
          areaLoopId = window.requestAnimationFrame(areaLoop);
        }
      };

      if (areaScroller && areaItems.length) {
        updateAreaFocus();
        ensureAreaLoop();
        window.addEventListener("resize", () => {
          updateAreaFocus();
          ensureAreaLoop();
        });
        window.addEventListener("scroll", ensureAreaLoop, { passive: true });
        document.addEventListener("visibilitychange", ensureAreaLoop);
      }

      const translations = {
        it: {
          "nav.about": "Chi siamo",
          "nav.services": "Servizi",
          "nav.electrical": "Impianti elettrici",
          "nav.solar": "Fotovoltaico",
          "nav.wallbox": "Wallbox",
          "nav.security": "Videosorveglianza",
          "nav.domotics": "Domotica",
          "nav.networks": "Reti",
          "nav.contacts": "Contatti",
          "hero.title": "Energia intelligente, sicurezza concreta.",
          "hero.lead":
            "Eletwave e una realta dinamica specializzata nella progettazione, realizzazione e manutenzione di impianti elettrici e soluzioni tecnologiche integrate per privati e aziende. Con sede in Friuli Venezia Giulia e operativita su un ampio territorio, offriamo servizi completi che spaziano dagli impianti elettrici civili e industriali alla domotica, sicurezza, automazioni ed energie rinnovabili, accompagnando il cliente in ogni fase del progetto: dall'analisi delle esigenze fino all'assistenza post-installazione.",
          "hero.lead.more.1":
            "L'azienda nasce dall'iniziativa di professionisti del settore con una solida esperienza nell'impiantistica elettrica e una forte attenzione all'innovazione tecnologica. La competenza maturata sul campo, unita alla formazione continua e al costante aggiornamento sulle normative di sicurezza, consente di proporre soluzioni efficienti, sicure e su misura, progettate per migliorare comfort, prestazioni energetiche e funzionalita degli ambienti.",
          "hero.lead.more.2":
            "L'obiettivo di Eletwave e diventare un punto di riferimento per chi cerca qualita, trasparenza e supporto costante nel tempo. Crediamo nel valore del rapporto diretto con il cliente, nella cura dei dettagli e in un servizio completo capace di coniugare innovazione, affidabilita e sostenibilita, garantendo risultati concreti e duraturi.",
          "hero.more": "Approfondisci",
          "hero.less": "Mostra meno",
          "services.title": "Servizi",
          "services.electrical.title": "Impianti elettrici",
          "services.electrical.desc":
            "Realizziamo impianti civili e industriali a norma, con quadri, linee e punti luce progettati in base agli ambienti. Eseguiamo verifiche strumentali, adeguamenti normativi e manutenzione programmata. Interveniamo rapidamente su guasti e anomalie per ridurre i tempi di fermo.",
          "services.solar.title": "Impianti fotovoltaici con accumulo",
          "services.solar.desc":
            "Progettiamo impianti fotovoltaici con accumulo dimensionati sui consumi reali, per aumentare autoconsumo ed efficienza. Installiamo inverter e batterie di ultima generazione con monitoraggio da app. Gestiamo pratiche, configurazione e assistenza per mantenere alte le prestazioni nel tempo.",
          "services.wallbox.title": "Wallbox per ricarica EV",
          "services.wallbox.desc":
            "Forniamo wallbox per ricarica domestica e aziendale con potenza configurata e protezioni dedicate. Integriamo la ricarica con impianto fotovoltaico e gestione intelligente dei carichi. Configuriamo fasce orarie, priorita e monitoraggio per una ricarica sicura, veloce ed efficiente.",
          "services.security.title": "Videosorveglianza e antifurti",
          "services.security.desc":
            "Installiamo sistemi di videosorveglianza e antifurto personalizzati per abitazioni, uffici e attivita commerciali. Configuriamo accesso remoto, notifiche in tempo reale e registrazione protetta su cloud o NVR. Ottimizziamo copertura e sensibilita per ridurre falsi allarmi e aumentare la sicurezza.",
          "services.domotics.title": "Domotica",
          "services.domotics.desc":
            "Progettiamo soluzioni domotiche per controllare luci, clima, tapparelle e accessi da app, voce o scenari automatici. Integriamo dispositivi compatibili in un unico sistema semplice da usare. Miglioriamo comfort, efficienza energetica e sicurezza con logiche su misura per ogni ambiente.",
          "services.networks.title": "Reti e cablaggi",
          "services.networks.desc":
            "Realizziamo reti dati e cablaggi strutturati per case, uffici e capannoni con rack ordinati e punti certificati. Configuriamo switch, Wi-Fi e segmentazione di rete per connessioni stabili e veloci. Eseguiamo test e collaudo per garantire continuita operativa e affidabilita nel tempo.",
          "services.scroll": "Scorri",
          "services.expand": "Tocca o premi Invio sulla card per aprire il testo",
          "areas.title": "Operativi a",
          "contacts.title": "Contatti",
          "contacts.phone": "Telefono: +39 3930036372",
          "contacts.email": "Email: <a href=\"mailto:eletwave@gmail.com\">eletwave@gmail.com</a>",
          "contacts.area": "Zona operativa: FVG",
          "contacts.vat": "P.IVA: 01287600314",
          "quote.title": "Richiedi un preventivo",
          "quote.lead": "Compila il modulo e ti ricontattiamo con una proposta su misura.",
          "quote.name": "Nome e cognome",
          "quote.phone": "Telefono",
          "quote.email": "Email",
          "quote.service": "Servizio di interesse",
          "quote.service.choose": "Seleziona un servizio",
          "quote.service.electrical": "Impianti elettrici",
          "quote.service.solar": "Impianti fotovoltaici",
          "quote.service.wallbox": "Wallbox",
          "quote.service.security": "Videosorveglianza e antifurti",
          "quote.service.domotics": "Domotica",
          "quote.service.networks": "Reti e cablaggi",
          "quote.message": "Dettagli del progetto",
          "quote.submit": "Invia richiesta",
          "quote.note": "Risposta rapida via email o telefono.",
          "quote.subject": "Richiesta preventivo sito web",
          "quote.field.name": "Nome",
          "quote.field.phone": "Telefono",
          "quote.field.email": "Email",
          "quote.field.service": "Servizio",
          "quote.field.message": "Dettagli",
          "quote.placeholder.name": "Mario Rossi",
          "quote.placeholder.phone": "+39 3xx xxx xxxx",
          "quote.placeholder.email": "nome@azienda.it",
          "quote.placeholder.message": "Descrivi brevemente l'intervento richiesto",
          "footer.nav": "Navigazione",
          "footer.note": "ELETWAVE. smart energy & security solutions"
        },
        en: {
          "nav.about": "About",
          "nav.services": "Services",
          "nav.electrical": "Electrical",
          "nav.solar": "Solar",
          "nav.wallbox": "Wallbox",
          "nav.security": "Security",
          "nav.domotics": "Domotics",
          "nav.networks": "Networks",
          "nav.contacts": "Contacts",
          "hero.title": "Smart energy, real security.",
          "hero.lead":
            "Eletwave is a dynamic company specialized in the design, implementation, and maintenance of electrical systems and integrated technology solutions for private clients and businesses. Based in Friuli Venezia Giulia and operating across a wide territory, we provide complete services ranging from residential and industrial electrical systems to domotics, security, automation, and renewable energy, supporting clients through every project phase: from needs analysis to post-installation assistance.",
          "hero.lead.more.1":
            "The company was founded by industry professionals with solid experience in electrical engineering and a strong focus on technological innovation. Field expertise, continuous training, and constant updates on safety regulations allow us to deliver efficient, safe, and tailored solutions designed to improve comfort, energy performance, and the functionality of spaces.",
          "hero.lead.more.2":
            "Eletwave's goal is to become a trusted reference for those seeking quality, transparency, and consistent support over time. We believe in direct client relationships, attention to detail, and a complete service that combines innovation, reliability, and sustainability to deliver concrete, long-lasting results.",
          "hero.more": "Read more",
          "hero.less": "Show less",
          "services.title": "Services",
          "services.electrical.title": "Electrical systems",
          "services.electrical.desc":
            "We deliver compliant residential and industrial electrical systems with panels, lines, and lighting points designed around each space. We perform technical checks, regulation upgrades, and scheduled maintenance. We also provide fast troubleshooting to reduce downtime and restore full operation quickly.",
          "services.solar.title": "Solar with storage",
          "services.solar.desc":
            "We design solar and storage systems sized around real energy usage to increase self-consumption and efficiency. We install modern inverters and batteries with app-based monitoring. We handle setup, configuration, and support to keep performance high over time.",
          "services.wallbox.title": "EV wallbox charging",
          "services.wallbox.desc":
            "We provide EV wallboxes for homes and businesses with configured power and dedicated electrical protection. Charging can be integrated with solar production and smart load management. We configure schedules, priorities, and monitoring for safe and efficient daily charging.",
          "services.security.title": "CCTV and alarms",
          "services.security.desc":
            "We install custom CCTV and alarm systems for homes, offices, and commercial spaces. Systems include remote access, real-time alerts, and secure cloud or NVR recording. We tune coverage and sensitivity to reduce false alarms and improve protection.",
          "services.domotics.title": "Domotics",
          "services.domotics.desc":
            "We build domotic solutions to control lights, climate, shutters, and access from app, voice, or automations. Compatible devices are integrated into one simple control system. The result is better comfort, energy efficiency, and everyday safety.",
          "services.networks.title": "Networks and cabling",
          "services.networks.desc":
            "We build structured data networks and cabling for homes, offices, and industrial sites with organized racks and certified points. We configure switching, Wi-Fi, and network segmentation for stable and fast connectivity. Final tests and commissioning ensure reliability over time.",
          "services.scroll": "Scroll",
          "services.expand": "Tap or press Enter on the card to open the text",
          "areas.title": "Operating in",
          "contacts.title": "Contacts",
          "contacts.phone": "Phone: +39 3930036372",
          "contacts.email": "Email: <a href=\"mailto:eletwave@gmail.com\">eletwave@gmail.com</a>",
          "contacts.area": "Operating area: FVG",
          "contacts.vat": "VAT: 01287600314",
          "quote.title": "Request a quote",
          "quote.lead": "Fill in the form and we will get back to you with a tailored proposal.",
          "quote.name": "Full name",
          "quote.phone": "Phone",
          "quote.email": "Email",
          "quote.service": "Service of interest",
          "quote.service.choose": "Select a service",
          "quote.service.electrical": "Electrical systems",
          "quote.service.solar": "Solar systems",
          "quote.service.wallbox": "Wallbox",
          "quote.service.security": "CCTV and alarms",
          "quote.service.domotics": "Domotics",
          "quote.service.networks": "Networks and cabling",
          "quote.message": "Project details",
          "quote.submit": "Send request",
          "quote.note": "Fast response by email or phone.",
          "quote.subject": "Website quote request",
          "quote.field.name": "Name",
          "quote.field.phone": "Phone",
          "quote.field.email": "Email",
          "quote.field.service": "Service",
          "quote.field.message": "Details",
          "quote.placeholder.name": "Mario Rossi",
          "quote.placeholder.phone": "+39 3xx xxx xxxx",
          "quote.placeholder.email": "name@company.com",
          "quote.placeholder.message": "Briefly describe the requested project",
          "footer.nav": "Navigation",
          "footer.note": "ELETWAVE. smart energy & security solutions"
        },
        sl: {
          "nav.about": "O nas",
          "nav.services": "Storitve",
          "nav.electrical": "Elektrika",
          "nav.solar": "Fotovoltaika",
          "nav.wallbox": "Wallbox",
          "nav.security": "Varnost",
          "nav.domotics": "Domotika",
          "nav.networks": "Omrezja",
          "nav.contacts": "Kontakti",
          "hero.title": "Pametna energija, resnicna varnost.",
          "hero.lead":
            "Eletwave je dinamicno podjetje, specializirano za nacrtovanje, izvedbo in vzdrzevanje elektricnih sistemov ter integriranih tehnoloskih resitev za zasebne in poslovne stranke. S sedezem v Furlaniji-Julijski krajini in delovanjem na sirokem obmocju nudimo celovite storitve od stanovanjskih in industrijskih elektricnih instalacij do domotike, varnosti, avtomatizacije in obnovljivih virov energije ter spremljamo stranko v vseh fazah projekta: od analize potreb do podpore po izvedbi.",
          "hero.lead.more.1":
            "Podjetje je nastalo na pobudo strokovnjakov z bogatimi izkusnjami na podrocju elektricnih instalacij in z mocnim poudarkom na tehnoloskih inovacijah. Znanje s terena, stalno izobrazevanje in redno spremljanje varnostnih predpisov nam omogocajo pripravo ucinkovitih, varnih in prilagojenih resitev za boljse udobje, energetsko ucinkovitost in funkcionalnost prostorov.",
          "hero.lead.more.2":
            "Cilj podjetja Eletwave je postati referencna izbira za vse, ki iscejo kakovost, preglednost in stalno podporo skozi cas. Verjamemo v neposreden odnos s stranko, pozornost do podrobnosti in celovito storitev, ki zdruzuje inovacije, zanesljivost in trajnost za konkretne in dolgotrajne rezultate.",
          "hero.more": "Preberi vec",
          "hero.less": "Prikazi manj",
          "services.title": "Storitve",
          "services.electrical.title": "Elektricni sistemi",
          "services.electrical.desc":
            "Izvajamo skladne stanovanjske in industrijske elektricne sisteme s paneli, vodi in svetlobnimi tockami, prilagojenimi prostoru. Opravljamo meritve, uskladitve s predpisi in nacrtovano vzdrzevanje. Ob okvarah posredujemo hitro, da skrajsamo cas izpada.",
          "services.solar.title": "Fotovoltaika z hranilniki",
          "services.solar.desc":
            "Nacrtujemo fotovoltaicne sisteme z hranilniki glede na dejansko porabo, za visjo samooskrbo in ucinkovitost. Vgradimo sodobne razsmernike in baterije z nadzorom prek aplikacije. Poskrbimo za nastavitev, konfiguracijo in podporo za dolgorocno visoko delovanje.",
          "services.wallbox.title": "Wallbox polnjenje EV",
          "services.wallbox.desc":
            "Dobavimo wallbox polnilnice za dom in podjetje z nastavljeno mocjo in namensko elektricno zascito. Polnjenje lahko povezemo s fotovoltaiko in pametnim upravljanjem porabe. Nastavimo urnike, prioritete in nadzor za varno ter ucinkovito uporabo.",
          "services.security.title": "Videonadzor in alarmi",
          "services.security.desc":
            "Vgrajujemo prilagojene sisteme videonadzora in alarmov za domove, pisarne in poslovne prostore. Omogocimo oddaljen dostop, obvestila v realnem casu in varno snemanje v oblaku ali na NVR. Pokritost in zaznavanje optimiziramo za manj laznih alarmov in vecjo varnost.",
          "services.domotics.title": "Domotika",
          "services.domotics.desc":
            "Pripravljamo domoticne resitve za upravljanje luci, klime, sencil in dostopa prek aplikacije, glasu ali scenarijev. Zdruzimo zdruzljive naprave v enostaven skupni sistem. Tako izboljsamo udobje, energetsko ucinkovitost in dnevno varnost.",
          "services.networks.title": "Omrezja in kabliranje",
          "services.networks.desc":
            "Izvajamo strukturirana podatkovna omrezja in kabliranje za domove, pisarne in industrijske objekte z urejenimi racki in certificiranimi tockami. Nastavimo switching, Wi-Fi in segmentacijo omrezja za stabilne in hitre povezave. Z zakljucnimi testi zagotovimo zanesljivo delovanje skozi cas.",
          "services.scroll": "Pomakni",
          "services.expand": "Tapni ali pritisni Enter na kartico za prikaz besedila",
          "areas.title": "Aktivni v",
          "contacts.title": "Kontakti",
          "contacts.phone": "Telefon: +39 3930036372",
          "contacts.email": "E-posta: <a href=\"mailto:eletwave@gmail.com\">eletwave@gmail.com</a>",
          "contacts.area": "Obmocje dela: FVG",
          "contacts.vat": "DDV: 01287600314",
          "quote.title": "Zahtevaj ponudbo",
          "quote.lead": "Izpolnite obrazec in pripravimo prilagojeno ponudbo.",
          "quote.name": "Ime in priimek",
          "quote.phone": "Telefon",
          "quote.email": "E-posta",
          "quote.service": "Izbrana storitev",
          "quote.service.choose": "Izberite storitev",
          "quote.service.electrical": "Elektricni sistemi",
          "quote.service.solar": "Fotovoltaika",
          "quote.service.wallbox": "Wallbox",
          "quote.service.security": "Videonadzor in alarmi",
          "quote.service.domotics": "Domotika",
          "quote.service.networks": "Omrezja in kabliranje",
          "quote.message": "Podrobnosti projekta",
          "quote.submit": "Poslji zahtevo",
          "quote.note": "Hiter odgovor po e-posti ali telefonu.",
          "quote.subject": "Zahteva za ponudbo s spletne strani",
          "quote.field.name": "Ime",
          "quote.field.phone": "Telefon",
          "quote.field.email": "E-posta",
          "quote.field.service": "Storitev",
          "quote.field.message": "Podrobnosti",
          "quote.placeholder.name": "Mario Rossi",
          "quote.placeholder.phone": "+39 3xx xxx xxxx",
          "quote.placeholder.email": "ime@podjetje.si",
          "quote.placeholder.message": "Na kratko opisite zeljeni poseg",
          "footer.nav": "Navigacija",
          "footer.note": "ELETWAVE. smart energy & security solutions"
        }
      };

      const updateServiceMediaLabels = (lang) => {
        const dict = translations[lang] || translations.it;
        const label = dict["services.expand"] || translations.it["services.expand"];
        document.querySelectorAll(".service-media").forEach((media) => {
          media.setAttribute("aria-label", label);
        });
      };

      const applyTranslations = (lang) => {
        const dict = translations[lang] || translations.it;
        currentLang = lang;
        document.documentElement.lang = lang;
        document.querySelectorAll("[data-i18n]").forEach((el) => {
          const key = el.getAttribute("data-i18n");
          if (dict[key]) {
            el.textContent = dict[key];
          }
        });
        document.querySelectorAll("[data-i18n-html]").forEach((el) => {
          const key = el.getAttribute("data-i18n-html");
          if (dict[key]) {
            el.innerHTML = dict[key];
          }
        });
        document.querySelectorAll("[data-i18n-placeholder]").forEach((el) => {
          const key = el.getAttribute("data-i18n-placeholder");
          if (dict[key]) {
            el.setAttribute("placeholder", dict[key]);
          }
        });
        if (langSelect) {
          langSelect.value = lang;
        }
        updateHeroMoreLabel(lang);
        syncHeroMoreHeight();
        updateServiceMediaLabels(lang);
      };

      const savedLang = localStorage.getItem("eletwave-lang") || "it";
      applyTranslations(savedLang);
      if (heroMoreButton && heroMoreContent) {
        setHeroMoreExpanded(false);
        heroMoreButton.addEventListener("click", () => {
          const isExpanded = heroMoreButton.getAttribute("aria-expanded") === "true";
          setHeroMoreExpanded(!isExpanded);
        });
        window.addEventListener("resize", syncHeroMoreHeight);
      }
      if (serviceMediaItems.length) {
        serviceMediaItems.forEach((media, index) => {
          const image = media.querySelector(".service-image");
          const description = media.querySelector(".service-description");
          if (!image) {
            return;
          }
          if (description && !description.id) {
            description.id = `service-description-${index + 1}`;
            media.setAttribute("aria-controls", description.id);
          }
          media.setAttribute("role", "button");
          media.setAttribute("tabindex", "0");
          setServiceDescriptionExpanded(media, false);
          const handleMediaActivation = () => {
            const card = media.closest(".service-card");
            if (!card) {
              return;
            }
            if (!card.classList.contains("is-active")) {
              card.scrollIntoView({
                behavior: prefersReducedMotion ? "auto" : "smooth",
                inline: "center",
                block: "nearest"
              });
              return;
            }
            toggleServiceDescription(media);
          };
          media.addEventListener("click", handleMediaActivation);
          media.addEventListener("keydown", (event) => {
            if (event.key === "Enter" || event.key === " ") {
              event.preventDefault();
              handleMediaActivation();
            }
          });
        });
      }
      if (quoteForm) {
        quoteForm.addEventListener("submit", (event) => {
          event.preventDefault();
          const formData = new FormData(quoteForm);
          const name = String(formData.get("name") || "").trim();
          const phone = String(formData.get("phone") || "").trim();
          const email = String(formData.get("email") || "").trim();
          const message = String(formData.get("message") || "").trim();
          let serviceText = "";
          if (quoteServiceSelect && quoteServiceSelect.selectedOptions.length) {
            serviceText = quoteServiceSelect.selectedOptions[0].textContent.trim();
          }
          const dict = translations[currentLang] || translations.it;
          const getCopy = (key, fallback) => dict[key] || translations.it[key] || fallback;
          const subject = getCopy("quote.subject", "Richiesta preventivo sito web");
          const body = [
            `${getCopy("quote.field.name", "Nome")}: ${name || "-"}`,
            `${getCopy("quote.field.phone", "Telefono")}: ${phone || "-"}`,
            `${getCopy("quote.field.email", "Email")}: ${email || "-"}`,
            `${getCopy("quote.field.service", "Servizio")}: ${serviceText || "-"}`,
            "",
            `${getCopy("quote.field.message", "Dettagli")}:`,
            message || "-"
          ].join("\n");
          const mailto = `mailto:eletwave@gmail.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
          window.location.href = mailto;
        });
      }
      if (langSelect) {
        langSelect.value = savedLang;
        langSelect.addEventListener("change", () => {
          const lang = langSelect.value;
          localStorage.setItem("eletwave-lang", lang);
          applyTranslations(lang);
        });
      }

      internalAnchorLinks.forEach((link) => {
        const hash = link.getAttribute("href");
        if (!hash || hash === "#") {
          return;
        }
        link.addEventListener("click", (event) => {
          const handledByService = scrollToServiceByHash(hash);
          const handledBySection = handledByService ? true : scrollToHashTarget(hash);
          if (!handledBySection) {
            return;
          }
          event.preventDefault();
          if (history.replaceState) {
            history.replaceState(null, "", hash);
          }
        });
      });

      if (window.location.hash) {
        window.setTimeout(() => {
          if (!scrollToServiceByHash(window.location.hash, "auto")) {
            scrollToHashTarget(window.location.hash, "auto");
          }
        }, 0);
      }

      if (scrollContainer) {
        const updateSnapPadding = () => {
          const firstCard = scrollContainer.querySelector(".scroll-card");
          if (!firstCard) {
            return;
          }
          const containerWidth = scrollContainer.getBoundingClientRect().width;
          const cardWidth = firstCard.getBoundingClientRect().width;
          const sidePadding = Math.max(0, (containerWidth - cardWidth) / 2);
          scrollContainer.style.scrollPaddingLeft = `${sidePadding}px`;
          scrollContainer.style.scrollPaddingRight = `${sidePadding}px`;
        };

        updateSnapPadding();

        getClosestCard = () => {
          const containerRect = scrollContainer.getBoundingClientRect();
          const centerX = containerRect.left + containerRect.width / 2;
          let closest = null;
          let closestDist = Infinity;

          cards.forEach((card) => {
            const rect = card.getBoundingClientRect();
            const cardCenter = rect.left + rect.width / 2;
            const dist = Math.abs(centerX - cardCenter);
            if (dist < closestDist) {
              closestDist = dist;
              closest = card;
            }
          });

          return closest;
        };

        const updateActiveCard = () => {
          const closest = getClosestCard();
          cards.forEach((card) => {
            const isClosest = card === closest;
            card.classList.toggle("is-active", isClosest);
            if (!isClosest) {
              const media = card.querySelector(".service-media");
              setServiceDescriptionExpanded(media, false);
            }
          });
          const activeIndex = closest ? cards.indexOf(closest) : 0;
          if (scrollPrevButton) {
            scrollPrevButton.disabled = activeIndex <= 0;
          }
          if (scrollNextButton) {
            scrollNextButton.disabled = activeIndex >= cards.length - 1;
          }
          updateActiveNav();
          cardsTicking = false;
        };

        const scrollToCard = (nextIndex) => {
          const targetIndex = Math.min(Math.max(nextIndex, 0), cards.length - 1);
          const targetCard = cards[targetIndex];
          if (!targetCard) {
            return;
          }
          targetCard.scrollIntoView({
            behavior: prefersReducedMotion ? "auto" : "smooth",
            inline: "center",
            block: "nearest"
          });
        };

        const onCardsScroll = () => {
          if (!cardsTicking) {
            window.requestAnimationFrame(() => {
              updateActiveCard();
              cardsTicking = false;
            });
            cardsTicking = true;
          }
        };

        scrollContainer.addEventListener("scroll", onCardsScroll, { passive: true });
        if (scrollPrevButton) {
          scrollPrevButton.addEventListener("click", () => {
            const closest = getClosestCard();
            const activeIndex = closest ? cards.indexOf(closest) : 0;
            scrollToCard(activeIndex - 1);
          });
        }
        if (scrollNextButton) {
          scrollNextButton.addEventListener("click", () => {
            const closest = getClosestCard();
            const activeIndex = closest ? cards.indexOf(closest) : 0;
            scrollToCard(activeIndex + 1);
          });
        }
        window.addEventListener("resize", () => {
          updateSnapPadding();
          onCardsScroll();
        });
        updateActiveCard();
      }

    </script>
  </body>
</html>
